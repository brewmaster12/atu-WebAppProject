<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>

    <style>
        body {
            background-color: bisque;
        }
    </style>
</head>
<body>
    <div class="container">
      <h1>Checkout</h1>

      <h2 id="cart_items"></h2>
      <h2 id="order_total"></h2>


      <form id="purchaseForm">
        <label for="name">Name:</label>
        <input type="text" id="name" name="name" required>

        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>

        <label for="address">Address:</label>
        <textarea id="address" name="address" required></textarea>

        <label for="payment">Payment Method:</label>
        <select id="payment" name="payment">
          <option value="credit-card">Credit Card</option>
          <option value="paypal">PayPal</option>
          <option value="stripe">Stripe</option>
        </select>

        <button type="submit">Place Order</button>
        <a href="index.html">Back to shop</a>

      </form>
    
</body>
</html>

<script>
    // Display the cart content and charges
    // Initialise total charge variable
    let total_charge = 0;
    // Iterate through all items in local storage
    for(i = 0; i < localStorage.length; i++) {
        let product = localStorage.key(i);
        let content = JSON.parse(localStorage.getItem(product));
        // Multiplies the price of the item and the quantity
        let total_cost = content.quan * content.p;
        // Adds it to the total charge
        total_charge += total_cost;
        // If the cart isn't empty ...
        if(content.quan > 0) {
            // Prints the cart contents to the page
            document.getElementById("cart_items").innerHTML +=  product + " x " + content.quan + " = €" + total_cost + "<br>";
        }
        // Prints the total charge to the page
        document.getElementById("order_total").innerHTML = "TOTAL = €" + total_charge;
    }

    // Functionality for the "Place Order" button
    document.getElementById("purchaseForm").addEventListener("submit", function(event) {
        // Prevent default form submission
        event.preventDefault();
        // Clears local storage
        localStorage.clear();
        // Alert user that the order was successfuly
        alert("Thank you for your order! You will now be taken back to the home page.");
        // Redirect to home page (index.html) after the alert
        window.location.href = "index.html";
    });

</script>